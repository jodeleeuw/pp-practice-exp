<!DOCTYPE html>
<html>
<head>
  <script src="jspsych-6.0.3/jspsych.js"></script>
  <script src="jspsych-6.0.3/plugins/jspsych-html-button-response.js"></script>
  <script src="custom_plugins/jspsych-memory-quiz.js"></script>
  <script src="custom_plugins/jspsych-dialog.js"></script>
  <link rel="stylesheet" type="text/css" href="jspsych-6.0.3/css/jspsych.css"></link>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <style>

  body {
    background: repeating-linear-gradient(
      90deg,
      hsla(232, 41%, 56%, 1),
      hsla(232, 41%, 56%, 1) 3px,
      hsla(232, 41%, 60%, 1) 3px,
      hsla(232, 41%, 60%, 1) 18px
    );
  }

  .dialog-btn {
    background: #FFA500;
    color: white;
    border-radius: 4px;
    padding: 12px 24px;
    border-style: none;
    cursor: pointer;
    /*box-shadow: 0 1px 1px 0 rgba(0,0,0,0.5);*/
  }

  .dialog-btn:hover {
    background: #FF8C00;
  }
  </style>
</head>
<body>
</body>
<script>

var study_duration = 1000;

var word_pairs = [
  {cue:"money", target: "velvet"},
  {cue:"robber", target: "stairway"},
  {cue:"college", target: "pest"},
  {cue:"body", target: "stripe"},
  {cue:"hand", target: "holiday"},
  {cue:"glacier", target: "cylinder"}
]

var timeline = [];

var pre_exposure = {
  type: 'dialog',
  stimulus: '<p>This the dialog that starts the first exposure to the word pairs. Study each pair for testing later.</p>',
  button_html: '<button class="dialog-btn">%choice%</button>',
  choices: ["Got it. Let's go!"],
  post_trial_gap: 1000
}

timeline.push(pre_exposure);

var exposure_phase_stimuli = jsPsych.randomization.shuffle(jsPsych.utils.deepCopy(word_pairs));

for(var i=0; i<exposure_phase_stimuli.length; i++){
  timeline.push({
    type: 'memory-quiz',
    cue: exposure_phase_stimuli[i].cue,
    target: exposure_phase_stimuli[i].target,
    display: 'pair',
    study_duration: study_duration,
    shiny: false,
    slide_in: i == 0 ? true : false,
    question_number: i+1,
    total_questions: exposure_phase_stimuli.length,
    next_cue: i < exposure_phase_stimuli.length-1 ? exposure_phase_stimuli[i+1].cue : '',
    next_target: i < exposure_phase_stimuli.length-1 ? exposure_phase_stimuli[i+1].target : '',
    next_display: 'pair',
    next_shiny: false
  })
}

var pre_study = {
  type: 'dialog',
  stimulus: '<p>This the dialog that starts the practice phase. Practice each pair for testing later.</p>',
  button_html: '<button class="dialog-btn">%choice%</button>',
  choices: ["Got it. Let's go!"],
  post_trial_gap: 1000
}

timeline.push(pre_study);

var study_phase_stimuli = jsPsych.randomization.shuffle(jsPsych.utils.deepCopy(word_pairs));
var number_test = 2;
var precious_practice = true;
for(var i=0; i<study_phase_stimuli.length; i++){
  if(i < number_test){
    study_phase_stimuli[i].display = 'test'
    study_phase_stimuli[i].shiny = precious_practice;
  } else {
    study_phase_stimuli[i].display = 'pair'
    study_phase_stimuli[i].shiny = !precious_practice;
  }
}
study_phase_stimuli = jsPsych.randomization.shuffle(study_phase_stimuli);

for(var i=0; i<study_phase_stimuli.length; i++){
  timeline.push({
    type: 'memory-quiz',
    cue: study_phase_stimuli[i].cue,
    target: study_phase_stimuli[i].target,
    display: study_phase_stimuli[i].display,
    study_duration: study_duration,
    shiny: study_phase_stimuli[i].shiny,
    slide_in: i == 0 ? true : false,
    question_number: i+1,
    total_questions: study_phase_stimuli.length,
    next_cue: i < study_phase_stimuli.length-1 ? study_phase_stimuli[i+1].cue : '',
    next_target: i < study_phase_stimuli.length-1 ? study_phase_stimuli[i+1].target : '',
    next_display: i < study_phase_stimuli.length-1 ? study_phase_stimuli[i+1].display : '',
    next_shiny: i < study_phase_stimuli.length-1 ? study_phase_stimuli[i+1].shiny : false
  })
}

var post_study = {
  type: 'dialog',
  stimulus: '<p>Final dialog. Come back tomorrow!</p>',
  button_html: '<button class="dialog-btn">%choice%</button>',
  choices: ["Bye!"],
  post_trial_gap: 1000
}

timeline.push(post_study);

jsPsych.init({
  timeline: timeline
})

</script>
</html>
